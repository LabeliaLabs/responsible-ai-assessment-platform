{% extends 'base-evaluation.html' %}
{% load add_attr %}
{% load static %}
{% load i18n %}

{% block content %}

<div class="breadcrumbs">
    <a href="{% url 'home:user-profile' %}">{% trans 'Dashboard' %}</a>
    <span> ></span>
    <a href="{% url 'home:user-profile' %}">{% trans 'My evaluations' %}</a>
    <span> ></span>
    <a class="active-breadcrumb" href="#">{% trans 'Results' %}</a>
</div>

{% if evaluation.is_upgradable %}
<div class="upgrade-banner-section-evaluation">
    {% include "assessment/upgrade-banner.html" %}
</div>
{% endif %}

{% if messages %}
<ul class="messages margin-3em">
    {% for message in messages %}
    <li class=" alert alert-{{ message.tags }}" >{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}

<h1 class="h1-margin-breadcrumbs">{{evaluation.name}}</h1>

<div class="bg-white rounded-lg p-5 shadow">
    <h2 class="h6 font-weight-bold text-center mb-4">{% trans "Your score" %}</h2>

    <!-- Progress bar 1 -->
    <div class="progress progress-results mx-auto"
         data-value='{{evaluation_score}}'>
          <span class="progress-left progress-left-results">
              <span class="progress-bar progress-bar-results border-primary"></span>
          </span>
        <span class="progress-right progress-right-results">
              <span class="progress-bar progress-bar-results border-primary"></span>
          </span>
        <div class="progress-value progress-value-results w-100 h-100
           rounded-circle d-flex align-items-center justify-content-center">
            <div class="h2 font-weight-bold">{{evaluation_score}}<sup class="small"></sup></div>
        </div>
    </div>

    <div>
        <h6 class="font-weight-bold text-center mb-4 margin-70 remove-smaller-than-tablet">
            {% trans "Score per section" %}
        </h6>
        <div class="remove-smaller-than-tablet">
            {{radar_chart|safe}}
        </div>
    </div>
    <div class="margin-70 margin-bot-50">
        <p class="">{% blocktrans trimmed %}
            The synthetic score is on a total of 100 theoretical maximum points for your full
            assessment. It provides an indication of the organization maturity level concerning a responsible and
            trustworthy data science. At the end of 2020, the 50/100 threshold can be considered a very advanced
            maturity level.
            {% endblocktrans %}
        </p>
        <p class="">{% blocktrans trimmed %}
            The mechanism for calculating the score is described in the FAQ that you can consult
            {% endblocktrans %}<a href="{% url 'home:faq' %}" title="{% trans 'FAQ' %}"> {% trans "here." %}</a></p>
        <p class="">{% blocktrans trimmed %}
            Note: the score is a synthetic indication, not an end in itself. In particular, we invite
            you to consult the resources associated with each assessment element, which are excellent entry points for
            building skills on your topics of interest.
            {% endblocktrans %}
        </p>
    </div>
    <div class="row">
        <form action="{% url 'assessment:orga-summary' organisation.id %}" class="float-left margin-auto">
            <input class="btn btn-primary button-190-or-220" type="submit"
                   value="{% trans 'Back to the organisation summary' %}"/>
        </form>

        <form action="{{ evaluation.get_absolute_url }}" class="float-right margin-auto smartphone-margin-top">
            <input class="btn btn-primary button-190-or-220" type="submit" value="{% trans 'Modify' %}"/>
        </form>

        <form action="{{ evaluation.get_absolute_url }}results/pdf/" class="margin-auto margin-top-export-pdf">
            <input class="btn btn-primary button-190-or-220" type="submit" value="{% trans 'Export PDF' %}"/>
        </form>
    </div>
</div>
    <div class="response margin-70" id="responses">
        <h2>{% trans "Your answers" %}</h2>
        <!--    Need to create a new form, initiate with database, disable other choices-->
        {% for element in evaluation_element_list %}
        {% if element.master_evaluation_element.order_id == 1 %}
        <p>Section {{ element.section.master_section.order_id}}. {{ element.section.master_section.name }}
        </p>
        {% endif %}
        <div class="card ">
            <div class="card-header card-headers-results row" id="heading{{element.id}}">
                <p>Q{{element.section.master_section.order_id}}.{{element.master_evaluation_element.order_id}} :
                    {{element.master_evaluation_element.name}}
                </p>
            </div>
            <div class="card-content">
                {% if element.has_condition_on and element|is_not_applicable %}
                <div class='alert alert-warning' id="warningmessage{{element.id}}">
                    {% trans 'You are not concerned by this evaluation element' %}
                </div>
                {% endif %}
                <div class="question-name margin-all-20" id="question-name">
                    Q{{element.section.master_section.order_id}}.{{element.master_evaluation_element.order_id}}
                    {% trans ":" %}
                    {{element.master_evaluation_element.question_text}}
                </div>
                {% if element.master_evaluation_element.question_type == "radio" %}
                <p class="italic margin-all-20">
                    R{{element.section.master_section.order_id}}.{{element.master_evaluation_element.order_id}}
                    {% trans ": Please select one answer which best matches to your organisation situation" %}
                </p>

                {% elif element.master_evaluation_element.question_type == "checkbox"%}
                <p class="italic margin-all-20">
                    R{{element.section.master_section.order_id}}.{{element.master_evaluation_element.order_id}}
                    {% blocktrans trimmed %}
                    : Please select all the answers which best match to your organisation situation. Be
                    careful, some combinations are not coherent.
                    {% endblocktrans %}
                </p>

                {% endif %}

                {{ dic_form_results|get_item:element }}

            </div>
        </div>
        {% endfor %}
    </div>
    <div>
        <button class="btn btn-primary float-right" id="top-button" onclick="topFunction()"
                title="{% trans 'Top of the page' %}">{% trans 'Top of the page' %}
        </button>
    </div>



{% endblock %}