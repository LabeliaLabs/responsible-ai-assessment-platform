{% load static %}
{% load add_attr %}
{% load markdownify %}
{% load i18n %}

 <div id="error_messages"></div>

<!-- Titles of the tablist-->
<nav>
  <div class="nav nav-tabs" id="nav-tab" role="tablist">
    <a class="nav-item nav-link title-nav active" id="nav-favorite-tab" data-toggle="tab"
       href="#nav-favorite" role="tab" aria-controls="nav-favorite"
       aria-selected="true">{% trans "My favorite resources" %}</a>
    <a class="nav-item nav-link title-nav" id="nav-resources-tab" data-toggle="tab"
       href="#nav-resources" role="tab" aria-controls="nav-resources" aria-selected="false">{% trans "Resources" %}</a>
<!--      The glossary is temporary removed as long as the content is not ready to be deployed -->
<!--    <a class="nav-item nav-link title-nav" id="nav-glossary-tab" data-toggle="tab"-->
<!--       href="#nav-glossary" role="tab" aria-controls="nav-glossary" aria-selected="false">{% trans "Glossary" %}</a>-->
  </div>
</nav>

<!-- Content of the tablist -->
<div class="tab-content" id="nav-tabContent">
  <div class="tab-pane fade show active" id="nav-favorite" role="tabpanel" aria-labelledby="nav-favorite-tab">
      <ul style="display: inline-grid;" id="liked-resources-array">
          {% if resources %}
            {% for resource in resources %}
              <div class="grid-container-2-cols">
                 <div class="grid-item">
                    <li id="resource{{resource.id}}" class="object-linked list-with-disc margin-10 ">
                        [{{resource.type}}] - {{resource.text|markdownify}}
                    </li>
                 </div>
                  <div class="icon-list" >
                        <form id="{{resource.id}}" method='post' action="{% url 'home:user-profile' %}" >
                            {% csrf_token %}
                            <a onclick="remove(this, {{resource.id}})" name="unlike">
                                 <i class="fa fa-bookmark liked" id="resource_list{{resource.id}}"></i>
                            </a>
                        </form>
                    </div>
              </div>
            {% endfor %}
          {% else %}
           <p id="no-resources-message" class="margin-50"
                >{% trans "You do not have selected resources as favorite yet. You can do this in the next tab or during the evaluation by clicking on the small icon next to the resources. " %}
           </p>
          {% endif %}
            <p id="no-resources-message-temp" class="margin-50 display-none"
                >{% trans "You do not have selected resources as favorite yet. You can do this in the next tab or during the evaluation by clicking on the small icon next to the resources. " %}
           </p>

      </ul>
  </div>
  <div class="tab-pane fade" id="nav-resources" role="tabpanel" aria-labelledby="nav-resources-tab">
      {% for master_section in last_assessment.mastersection_set.all %}
        <div id="accordion-{{master_section.id}}" class="accordion-master-section margin-10" >
            <div class="card mb-0">
                <div class="card-header collapsed" data-toggle="collapse" href="#collapse-{{master_section.id}}"
                    style="background-color:white;">
                    <li class="list-with-disc">
                        <span class="fake-link" >Section {{master_section.order_id}}: {{master_section.name}}</span>
                    </li>
                </div>
                <div id="collapse-{{master_section.id}}" class="card-body collapse"
                     data-parent="#accordion-{{master_section.id}}">
                    <ul>
                    {% for master_element in master_section.masterevaluationelement_set.all %}
                        {% if master_element.has_resources %}
                                <li class="margin-10">
                                Q{{master_section.order_id}}.{{master_element.order_id}} : {{ master_element.name }}
                                <form id="like_resources{{master_element.id}}" action="" method="POST">
                                    {% csrf_token %}
                                    <ul>
                                        {% for resource in master_element.external_links.all %}
                                                <div class="grid-container-2-cols">
                                                    <div class="grid-item">
                                                        <li class="list-with-disc margin-10">
                                                        [{{resource.type}}] - {{resource.text|markdownify}}
                                                        </li>
                                                    </div>
                                                    <div class="icon-list">
                                                        {% if not resource in resources_liked %}
                                                            <a onclick="like(this, {{master_element.id}}, {{resource.id}})" name="like">
                                                                <i class="fa fa-bookmark-o  not-liked"
                                                                   title="{% trans 'Click to like the resource' %}"
                                                                   name="resource_not_liked{{resource.id}}"></i>
                                                            </a>
                                                        {% else %}
                                                            <a onclick="like(this, {{master_element.id}}, {{resource.id}})"
                                                               name="unlike">
                                                                <i class="fa fa-bookmark liked"
                                                                   title="{% trans 'Click to unlike the resource' %}"
                                                                   name="resource_liked{{resource.id}}"></i>
                                                            </a>
                                                        {% endif %}
                                                    </div>

                                                </div>
                                        {% endfor %}
                                    </ul>
                                    </form>
                            </li>

                        {% endif %}
                    {% endfor %}
                    </ul>
                </div>

            </div>
        </div>
      {% endfor %}
  </div>
<!--    Todo manage the glossary (new dedicated html file, see how to import/create it)-->
<!--  <div class="tab-pane fade" id="nav-glossary" role="tabpanel" aria-labelledby="nav-glossary-tab">-->
<!--      <ul class="margin-50">-->
<!--      <li class="list-with-disc">-->
<!--          <p><strong>{% trans "Privacy:" %}</strong>{% trans "the right to an individual to control who have access to his personal data."%}</p>-->
<!--      </li>-->
<!--      </ul>-->
<!--  </div>-->
</div>

